<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>NSProxy AOP -</title><meta name=Description content="This is Houugen's Hugo Site"><meta property="og:title" content="NSProxy AOP"><meta property="og:description" content="iOS AOPæ–‡ç« ç³»åˆ—
å‰å¯¼çŸ¥è¯†ï¼š
 Mach-Oæ–‡ä»¶ç»“æ„åˆ†æ é™æ€é“¾æ¥&åŠ¨æ€é“¾æ¥ OCæ–¹æ³•&OCç±»&OCå¯¹è±¡ æ–¹æ³•æŸ¥æ‰¾å’Œæ¶ˆæ¯è½¬å‘  AOPæ¡†æ¶ï¼š
 Method Swizzling Fishhook Apsects NSProxy AOP   ä»‹ç» iOS æœ‰ä¸€ä¸ªåŸç”Ÿçš„ AOP æ–¹æ³•ï¼Œå°±æ˜¯åˆ©ç”¨ NSProxy ä»£ç†ç±»ï¼ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹å®˜ç½‘ä»‹ç»ï¼š
 Typically, a message to a proxy is forwarded to the real object or causes the proxy to load (or transform itself into) the real object. Subclasses of NSProxy can be used to implement transparent distributed messaging (for example, NSDistantObject) or for lazy instantiation of objects that are expensive to create."><meta property="og:type" content="article"><meta property="og:url" content="http://houugen.fun/posts/nsproxy-aop.html"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-30T09:00:00+00:00"><meta property="article:modified_time" content="2021-03-30T09:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="NSProxy AOP"><meta name=twitter:description content="iOS AOPæ–‡ç« ç³»åˆ—
å‰å¯¼çŸ¥è¯†ï¼š
 Mach-Oæ–‡ä»¶ç»“æ„åˆ†æ é™æ€é“¾æ¥&åŠ¨æ€é“¾æ¥ OCæ–¹æ³•&OCç±»&OCå¯¹è±¡ æ–¹æ³•æŸ¥æ‰¾å’Œæ¶ˆæ¯è½¬å‘  AOPæ¡†æ¶ï¼š
 Method Swizzling Fishhook Apsects NSProxy AOP   ä»‹ç» iOS æœ‰ä¸€ä¸ªåŸç”Ÿçš„ AOP æ–¹æ³•ï¼Œå°±æ˜¯åˆ©ç”¨ NSProxy ä»£ç†ç±»ï¼ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹å®˜ç½‘ä»‹ç»ï¼š
 Typically, a message to a proxy is forwarded to the real object or causes the proxy to load (or transform itself into) the real object. Subclasses of NSProxy can be used to implement transparent distributed messaging (for example, NSDistantObject) or for lazy instantiation of objects that are expensive to create."><meta name=application-name content><meta name=apple-mobile-web-app-title content><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://houugen.fun/posts/nsproxy-aop.html><link rel=prev href=http://houugen.fun/posts/apsects.html><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"NSProxy AOP","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/houugen.fun\/posts\/nsproxy-aop.html"},"genre":"posts","keywords":"iOS, AOP","wordcount":325,"url":"http:\/\/houugen.fun\/posts\/nsproxy-aop.html","datePublished":"2021-03-30T09:00:00+00:00","dateModified":"2021-03-30T09:00:00+00:00","publisher":{"@type":"Organization","name":"Houugen"},"author":{"@type":"Person","name":"Houugen"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':'dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark')&&document.body.setAttribute('theme','dark')</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title>Houugen<span class=header-title-post>ãƒ¢ãƒ–</span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts.html>Posts </a><a class=menu-item href=/tags.html>Tags </a><a class=menu-item href=/categories.html>Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title>Houugen<span class=header-title-post>ãƒ¢ãƒ–</span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts.html title>Posts</a><a class=menu-item href=/tags.html title>Tags</a><a class=menu-item href=/categories.html title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">NSProxy AOP</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i>Houugen</a></span>&nbsp;<span class=post-category>included in <a href=/categories/ios.html><i class="far fa-folder fa-fw"></i>iOS</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-03-30>2021-03-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;325 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;2 minutes&nbsp;<span id=/posts/nsproxy-aop.html class=leancloud_visitors data-flag-title="NSProxy AOP">
<i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
</span>&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#ä»‹ç»>ä»‹ç»</a></li><li><a href=#--åœ¨ç›®>ğŸŒ° ğŸŒ° åœ¨ç›®</a></li><li><a href=#åŸç†>åŸç†</a></li></ul></nav></div></div><div class=content id=content><blockquote><p>iOS AOPæ–‡ç« ç³»åˆ—</p><p>å‰å¯¼çŸ¥è¯†ï¼š</p><ul><li><a href=https://houugen.fun/posts/mach-o%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90.html target=_blank rel="noopener noreffer">Mach-Oæ–‡ä»¶ç»“æ„åˆ†æ</a></li><li><a href=https://houugen.fun/posts/%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5.html target=_blank rel="noopener noreffer">é™æ€é“¾æ¥&åŠ¨æ€é“¾æ¥</a></li><li><a href=https://houugen.fun/posts/oc%E6%96%B9%E6%B3%95oc%E7%B1%BBoc%E5%AF%B9%E8%B1%A1.html target=_blank rel="noopener noreffer">OCæ–¹æ³•&OCç±»&OCå¯¹è±¡</a></li><li><a href=https://houugen.fun/posts/%E6%96%B9%E6%B3%95%E6%9F%A5%E6%89%BE%E5%92%8C%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91.html target=_blank rel="noopener noreffer">æ–¹æ³•æŸ¥æ‰¾å’Œæ¶ˆæ¯è½¬å‘</a></li></ul><p>AOPæ¡†æ¶ï¼š</p><ul><li><a href=https://houugen.fun/posts/method-swizzling.html target=_blank rel="noopener noreffer">Method Swizzling</a></li><li><a href=https://houugen.fun/posts/fishhook.html target=_blank rel="noopener noreffer">Fishhook</a></li><li><a href=https://houugen.fun/posts/apsects.html target=_blank rel="noopener noreffer">Apsects</a></li><li><a href=https://houugen.fun/posts/nsproxy-aop.html target=_blank rel="noopener noreffer">NSProxy AOP</a></li></ul></blockquote><h2 id=ä»‹ç»>ä»‹ç»</h2><p>iOS æœ‰ä¸€ä¸ªåŸç”Ÿçš„ <code>AOP</code> æ–¹æ³•ï¼Œå°±æ˜¯åˆ©ç”¨ <code>NSProxy</code> ä»£ç†ç±»ï¼ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹<a href=https://developer.apple.com/documentation/foundation/nsproxy target=_blank rel="noopener noreffer">å®˜ç½‘</a>ä»‹ç»ï¼š</p><blockquote><p>Typically, a message to a proxy is forwarded to the real object or causes the proxy to load (or transform itself into) the real object. Subclasses of <code>NSProxy</code> can be used to implement transparent distributed messaging (for example, <a href=https://developer.apple.com/documentation/foundation/nsdistantobject target=_blank rel="noopener noreffer"><code>NSDistantObject</code></a>) or for lazy instantiation of objects that are expensive to create.</p><p><code>NSProxy</code> implements the basic methods required of a root class, including those defined in the <a href=https://developer.apple.com/documentation/objectivec/nsobjectprotocol target=_blank rel="noopener noreffer"><code>NSObjectProtocol</code></a> protocol. However, as an abstract class it doesnâ€™t provide an initialization method, and it raises an exception upon receiving any message it doesnâ€™t respond to. A concrete subclass must therefore provide an initialization or creation method and override the <a href=https://developer.apple.com/documentation/foundation/nsproxy/1416417-forwardinvocation target=_blank rel="noopener noreffer"><code>forwardInvocation(_:)</code></a> and <a href=https://developer.apple.com/documentation/foundation/nsproxy/1589828-methodsignatureforselector target=_blank rel="noopener noreffer"><code>methodSignatureForSelector:</code></a> methods to handle messages that it doesnâ€™t implement itself.</p></blockquote><p>è¯´æ˜ä¸¤ç‚¹ï¼š</p><ol><li><code>NSProxy</code> æœ¬èº«å°±æ˜¯ç”¨æ¥åšä»£ç†è½¬å‘æ¶ˆæ¯çš„</li><li><code>NSProxy</code> çš„å­ç±»å¿…é¡»é€šè¿‡ <code>forwardInvocation</code> å’Œ <code>methodSignatureForselector</code> æ¥åˆ›å»ºæ–¹æ³•</li></ol><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw"></i>Note<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>è¿˜è®°å¾—æˆ‘ä»¬åœ¨æ–¹æ³•æŸ¥æ‰¾å’Œæ¶ˆæ¯è½¬å‘æ–‡ç« ä¸­æœ€åè®²çš„æ…¢é€Ÿæ¶ˆæ¯è½¬å‘è¿‡ç¨‹å—ï¼Ÿ</div></div></div><p><code>NSProxy</code> çš„å£°æ˜ï¼š</p><div class=highlight><pre class=chroma><code class=language-objective-c data-lang=objective-c><span class=n>NS_ROOT_CLASS</span>
<span class=k>@interface</span> <span class=nc>NSProxy</span> <span class=o>&lt;</span><span class=n>NSObject</span><span class=o>&gt;</span> <span class=p>{</span>
    <span class=n>__ptrauth_objc_isa_pointer</span> <span class=kt>Class</span>    <span class=n>isa</span><span class=p>;</span>
<span class=p>}</span>

<span class=o>+</span> <span class=p>(</span><span class=kt>id</span><span class=p>)</span><span class=n>alloc</span><span class=p>;</span>
<span class=p>+</span> <span class=p>(</span><span class=kt>id</span><span class=p>)</span><span class=nf>allocWithZone:</span><span class=p>(</span><span class=n>nullable</span> <span class=n>NSZone</span> <span class=o>*</span><span class=p>)</span><span class=nv>zone</span> <span class=n>NS_AUTOMATED_REFCOUNT_UNAVAILABLE</span><span class=p>;</span>
<span class=p>+</span> <span class=p>(</span><span class=kt>Class</span><span class=p>)</span><span class=nf>class</span><span class=p>;</span>

<span class=p>-</span> <span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=nf>forwardInvocation:</span><span class=p>(</span><span class=n>NSInvocation</span> <span class=o>*</span><span class=p>)</span><span class=nv>invocation</span><span class=p>;</span>
<span class=p>-</span> <span class=p>(</span><span class=n>nullable</span> <span class=n>NSMethodSignature</span> <span class=o>*</span><span class=p>)</span><span class=nf>methodSignatureForSelector:</span><span class=p>(</span><span class=kt>SEL</span><span class=p>)</span><span class=nv>sel</span> <span class=n>NS_SWIFT_UNAVAILABLE</span><span class=p>(</span><span class=s>&#34;NSInvocation and related APIs not available&#34;</span><span class=p>);</span>
<span class=p>-</span> <span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=nf>dealloc</span><span class=p>;</span>
<span class=p>-</span> <span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=nf>finalize</span><span class=p>;</span>
<span class=k>@property</span> <span class=p>(</span><span class=k>readonly</span><span class=p>,</span> <span class=k>copy</span><span class=p>)</span> <span class=n>NSString</span> <span class=o>*</span><span class=n>description</span><span class=p>;</span>
<span class=k>@property</span> <span class=p>(</span><span class=k>readonly</span><span class=p>,</span> <span class=k>copy</span><span class=p>)</span> <span class=n>NSString</span> <span class=o>*</span><span class=n>debugDescription</span><span class=p>;</span>
<span class=p>+</span> <span class=p>(</span><span class=kt>BOOL</span><span class=p>)</span><span class=nf>respondsToSelector:</span><span class=p>(</span><span class=kt>SEL</span><span class=p>)</span><span class=nv>aSelector</span><span class=p>;</span>

<span class=p>-</span> <span class=p>(</span><span class=kt>BOOL</span><span class=p>)</span><span class=nf>allowsWeakReference</span> <span class=n>API_UNAVAILABLE</span><span class=p>(</span><span class=n>macos</span><span class=p>,</span> <span class=n>ios</span><span class=p>,</span> <span class=n>watchos</span><span class=p>,</span> <span class=n>tvos</span><span class=p>);</span>
<span class=p>-</span> <span class=p>(</span><span class=kt>BOOL</span><span class=p>)</span><span class=nf>retainWeakReference</span> <span class=n>API_UNAVAILABLE</span><span class=p>(</span><span class=n>macos</span><span class=p>,</span> <span class=n>ios</span><span class=p>,</span> <span class=n>watchos</span><span class=p>,</span> <span class=n>tvos</span><span class=p>);</span>

<span class=c1>// - (id)forwardingTargetForSelector:(SEL)aSelector;
</span><span class=c1></span>
<span class=k>@end</span>
</code></pre></div><p>åŒ…å« <code>isa</code> æŒ‡é’ˆï¼Œè¯´æ˜å…¶æœ¬èº«å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å¹¶ä¸”éµå®ˆ <code>NSObjcet</code> åè®®ï¼Œè¿˜å­˜åœ¨ <code>forwardInvocation</code> å’Œ <code>methodSignatureForSelector</code> æ–¹æ³•ã€‚</p><h2 id=--åœ¨ç›®>ğŸŒ° ğŸŒ° åœ¨ç›®</h2><p>æ–°å¢ä¸€ä¸ª <code>MyProxy</code> ç±»ç»§æ‰¿ <code>NSProxy</code>ï¼Œå¹¶åœ¨å…¶ä¸­å®ç°ä¸€ä¸ªç›®æ ‡å¯¹è±¡çš„ä»£ç†å¼•ç”¨ï¼ŒåŒæ—¶å®ç°ä¸¤ä¸ªå…³é”®æ–¹æ³•:</p><div class=highlight><pre class=chroma><code class=language-objective-c data-lang=objective-c><span class=c1>// MyProxy.h
</span><span class=c1></span><span class=k>@interface</span> <span class=nc>MyProxy</span> : <span class=nc>NSProxy</span> <span class=p>{</span>
    <span class=kt>id</span> <span class=n>_target</span><span class=p>;</span>
<span class=p>}</span>

<span class=p>+</span> <span class=p>(</span><span class=kt>id</span><span class=p>)</span><span class=nf>proxyWithTarget:</span><span class=p>(</span><span class=kt>id</span><span class=p>)</span><span class=nv>target</span><span class=p>;</span>

<span class=k>@end</span>

<span class=c1>// MyProxy.m
</span><span class=c1></span><span class=k>@implementation</span> <span class=nc>MyProxy</span>

<span class=p>+</span> <span class=p>(</span><span class=kt>id</span><span class=p>)</span><span class=nf>proxyWithTarget:</span><span class=p>(</span><span class=kt>id</span><span class=p>)</span><span class=nv>target</span> <span class=p>{</span>
    <span class=n>MyProxy</span> <span class=o>*</span><span class=n>mp</span> <span class=o>=</span> <span class=p>[</span><span class=n>MyProxy</span> <span class=n>alloc</span><span class=p>];</span>
    <span class=n>mp</span><span class=o>-&gt;</span><span class=n>_target</span> <span class=o>=</span> <span class=n>target</span><span class=p>;</span>
    <span class=k>return</span> <span class=n>mp</span><span class=p>;</span>
<span class=p>}</span>

<span class=p>-</span> <span class=p>(</span><span class=n>NSMethodSignature</span> <span class=o>*</span><span class=p>)</span><span class=nf>methodSignatureForSelector:</span><span class=p>(</span><span class=kt>SEL</span><span class=p>)</span><span class=nv>sel</span> <span class=p>{</span>
    <span class=k>return</span> <span class=p>[</span><span class=n>_target</span> <span class=nl>methodSignatureForSelector</span><span class=p>:</span><span class=n>sel</span><span class=p>];</span>
<span class=p>}</span>

<span class=p>-</span> <span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=nf>forwardInvocation:</span><span class=p>(</span><span class=n>NSInvocation</span> <span class=o>*</span><span class=p>)</span><span class=nv>invocation</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>invocation</span> <span class=o>&amp;&amp;</span> <span class=p>[</span><span class=n>_target</span> <span class=nl>respondsToSelector</span><span class=p>:</span><span class=n>invocation</span><span class=p>.</span><span class=n>selector</span><span class=p>])</span> <span class=p>{</span>
        <span class=n>NSString</span> <span class=o>*</span><span class=n>sn</span> <span class=o>=</span> <span class=n>NSStringFromSelector</span><span class=p>(</span><span class=n>invocation</span><span class=p>.</span><span class=n>selector</span><span class=p>);</span>
        <span class=n>NSLog</span><span class=p>(</span><span class=s>@&#34;do something before %@&#34;</span><span class=p>,</span> <span class=n>sn</span><span class=p>);</span>
        <span class=p>[</span><span class=n>invocation</span> <span class=nl>invokeWithTarget</span><span class=p>:</span><span class=n>_target</span><span class=p>];</span>
        <span class=n>NSLog</span><span class=p>(</span><span class=s>@&#34;do something after %@&#34;</span><span class=p>,</span> <span class=n>sn</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>@end</span>

<span class=c1>// main.m ä¸­æ·»åŠ ä»£ç 
</span><span class=c1>//        ==== NSProxy ====
</span><span class=c1></span><span class=n>Person</span> <span class=o>*</span><span class=n>p</span> <span class=o>=</span> <span class=p>[</span><span class=n>MyProxy</span> <span class=nl>proxyWithTarget</span><span class=p>:[[</span><span class=n>Person</span> <span class=n>alloc</span><span class=p>]</span> <span class=n>init</span><span class=p>]];</span>
<span class=p>[</span><span class=n>p</span> <span class=n>sleep</span><span class=p>];</span>
<span class=p>[</span><span class=n>p</span> <span class=n>walk</span><span class=p>];</span>
</code></pre></div><figure><img src=./NSProxyAOP.assets/1617101686961-2f6bfb72-2849-4447-8697-45f570eeaa6a.png width=80%></figure><h2 id=åŸç†>åŸç†</h2><p><code>proxyWithTarget:</code> å®ç°å°†ä¸€ä¸ªå¯¹è±¡å¼•ç”¨åˆ°è‡ªå®ç°çš„ä»£ç†ç±»ä¸­ï¼Œåœ¨çœŸæ­£è°ƒç”¨å¯¹è±¡æ–¹æ³•æ—¶ï¼Œä»£ç†ç±»æ²¡æœ‰æ–¹æ³•å®šä¹‰ï¼Œæ‰¾ä¸åˆ°å¯¹åº”çš„ <code>IMP</code>ï¼Œå°±ä¼šè¿›å…¥æ¶ˆæ¯è½¬å‘æµç¨‹ï¼Œä»è€Œæ‰§è¡Œ <code>forwardInvocation:</code> ï¼Œè€Œæˆ‘ä»¬åœ¨ <code>forwardInvocation:</code> ä¸­æ‰§è¡ŒåŸæ–¹æ³•å‰ååŠ å…¥é¢å¤–é€»è¾‘å®ç° <code>AOP</code>ã€‚</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2021-03-30</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/ios.html>iOS</a>,&nbsp;<a href=/tags/aop.html>AOP</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/apsects.html class=prev rel=prev title=Apsects><i class="fas fa-angle-left fa-fw"></i>Apsects</a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2018 - 2021</span>&nbsp;|&nbsp;<span class=license>Houugen</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/valine/valine.min.css><script type=text/javascript src=/lib/valine/Valine.min.js></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/algoliasearch/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:20},comment:{valine:{appId:"QhRivi4Qm3PjvD0WoqEiJv5n-gzGzoHsz",appKey:"gHPJRKJ7Vfi2xHjiJ3AcP92S",avatar:"mp",el:"#valine",emojiCDN:"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/",emojiMaps:{100:"1f4af.png",alien:"1f47d.png",anger:"1f4a2.png",angry:"1f620.png",anguished:"1f627.png",astonished:"1f632.png",black_heart:"1f5a4.png",blue_heart:"1f499.png",blush:"1f60a.png",bomb:"1f4a3.png",boom:"1f4a5.png",broken_heart:"1f494.png",brown_heart:"1f90e.png",clown_face:"1f921.png",cold_face:"1f976.png",cold_sweat:"1f630.png",confounded:"1f616.png",confused:"1f615.png",cry:"1f622.png",crying_cat_face:"1f63f.png",cupid:"1f498.png",dash:"1f4a8.png",disappointed:"1f61e.png",disappointed_relieved:"1f625.png",dizzy:"1f4ab.png",dizzy_face:"1f635.png",drooling_face:"1f924.png",exploding_head:"1f92f.png",expressionless:"1f611.png",face_vomiting:"1f92e.png",face_with_cowboy_hat:"1f920.png",face_with_hand_over_mouth:"1f92d.png",face_with_head_bandage:"1f915.png",face_with_monocle:"1f9d0.png",face_with_raised_eyebrow:"1f928.png",face_with_rolling_eyes:"1f644.png",face_with_symbols_on_mouth:"1f92c.png",face_with_thermometer:"1f912.png",fearful:"1f628.png",flushed:"1f633.png",frowning:"1f626.png",ghost:"1f47b.png",gift_heart:"1f49d.png",green_heart:"1f49a.png",grimacing:"1f62c.png",grin:"1f601.png",grinning:"1f600.png",hankey:"1f4a9.png",hear_no_evil:"1f649.png",heart:"2764-fe0f.png",heart_decoration:"1f49f.png",heart_eyes:"1f60d.png",heart_eyes_cat:"1f63b.png",heartbeat:"1f493.png",heartpulse:"1f497.png",heavy_heart_exclamation_mark_ornament:"2763-fe0f.png",hole:"1f573-fe0f.png",hot_face:"1f975.png",hugging_face:"1f917.png",hushed:"1f62f.png",imp:"1f47f.png",innocent:"1f607.png",japanese_goblin:"1f47a.png",japanese_ogre:"1f479.png",joy:"1f602.png",joy_cat:"1f639.png",kiss:"1f48b.png",kissing:"1f617.png",kissing_cat:"1f63d.png",kissing_closed_eyes:"1f61a.png",kissing_heart:"1f618.png",kissing_smiling_eyes:"1f619.png",laughing:"1f606.png",left_speech_bubble:"1f5e8-fe0f.png",love_letter:"1f48c.png",lying_face:"1f925.png",mask:"1f637.png",money_mouth_face:"1f911.png",nauseated_face:"1f922.png",nerd_face:"1f913.png",neutral_face:"1f610.png",no_mouth:"1f636.png",open_mouth:"1f62e.png",orange_heart:"1f9e1.png",partying_face:"1f973.png",pensive:"1f614.png",persevere:"1f623.png",pleading_face:"1f97a.png",pouting_cat:"1f63e.png",purple_heart:"1f49c.png",rage:"1f621.png",relaxed:"263a-fe0f.png",relieved:"1f60c.png",revolving_hearts:"1f49e.png",right_anger_bubble:"1f5ef-fe0f.png",robot_face:"1f916.png",rolling_on_the_floor_laughing:"1f923.png",scream:"1f631.png",scream_cat:"1f640.png",see_no_evil:"1f648.png",shushing_face:"1f92b.png",skull:"1f480.png",skull_and_crossbones:"2620-fe0f.png",sleeping:"1f634.png",sleepy:"1f62a.png",slightly_frowning_face:"1f641.png",slightly_smiling_face:"1f642.png",smile:"1f604.png",smile_cat:"1f638.png",smiley:"1f603.png",smiley_cat:"1f63a.png",smiling_face_with_3_hearts:"1f970.png",smiling_imp:"1f608.png",smirk:"1f60f.png",smirk_cat:"1f63c.png",sneezing_face:"1f927.png",sob:"1f62d.png",space_invader:"1f47e.png",sparkling_heart:"1f496.png",speak_no_evil:"1f64a.png",speech_balloon:"1f4ac.png","star-struck":"1f929.png",stuck_out_tongue:"1f61b.png",stuck_out_tongue_closed_eyes:"1f61d.png",stuck_out_tongue_winking_eye:"1f61c.png",sunglasses:"1f60e.png",sweat:"1f613.png",sweat_drops:"1f4a6.png",sweat_smile:"1f605.png",thinking_face:"1f914.png",thought_balloon:"1f4ad.png",tired_face:"1f62b.png",triumph:"1f624.png",two_hearts:"1f495.png",unamused:"1f612.png",upside_down_face:"1f643.png",weary:"1f629.png",white_frowning_face:"2639-fe0f.png",white_heart:"1f90d.png",wink:"1f609.png",woozy_face:"1f974.png",worried:"1f61f.png",yawning_face:"1f971.png",yellow_heart:"1f49b.png",yum:"1f60b.png",zany_face:"1f92a.png",zipper_mouth_face:"1f910.png",zzz:"1f4a4.png"},enableQQ:!1,highlight:!0,lang:"en",pageSize:10,placeholder:"Your comment ...",recordIP:!0,serverURLs:"https://leancloud.cn",visitor:!0}},search:{algoliaAppID:"63ROI1DYLO",algoliaIndex:"houugen_blog",algoliaSearchKey:"0282c2777b386667ccc099a27da8a3cb",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>