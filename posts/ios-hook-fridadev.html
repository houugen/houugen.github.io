<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>iOS Hook FridaDev -</title><meta name=Description content="This is Houugen's Hugo Site"><meta property="og:title" content="iOS Hook FridaDev"><meta property="og:description" content="FridaDev ä½œä¸ºå¤§è‡ªç„¶çš„æ¬è¿å·¥å’Œç»„è£…å¸ˆå‚…ï¼Œæ”¶é›†å¹¶å¢å¼ºä¸€äº›éå¸¸æœ‰ç”¨çš„fridaè„šæœ¬å°è£…ä¸ºFridaDevå·¥å…·ï¼Œå¯ä»¥å®ç°ä¸€é”®å¼é€†å‘éœ€æ±‚ï¼Œæé«˜ç”Ÿäº§åŠ›ã€‚
è„šæœ¬æ¥æºï¼š
 https://github.com/0xdea/frida-scripts https://github.com/AloneMonkey/iOSREBook/tree/master/chapter-7/7.3%20Frida%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/Frida  ä¿®æ”¹ï¼š
 åŠ¨æ€hook uiå¢åŠ æ‰“å°controllerå’Œaction æ ¹æ®ç¨³å®šæ€§traceé€‰æ‹©spwanï¼Œå…¶ä»–åŠŸèƒ½é€‰æ‹©attach  ä»“åº“ç›´é€šè½¦ï¼šhttps://github.com/houugen/FridaDev
åŠŸèƒ½ usage: fridaDev.py [-h] [-l] [-i] [-u appName] [-d appName] [-t identifier] [-e identifier] frida tools optional arguments: -h, --help show this help message and exit -l, --list list running processes -i, --info list installed app infomation -u appName, --ui appName show UI (only for ios) -d appName, --dynhook appName dynamic hook -t identifier, --trace identifier ObjC/java and Module tracer -e identifier, --enumerate identifier Collection of functions to enumerate classes and list åŠŸèƒ½ï¼šåˆ—å‡ºè¿è¡Œè¿›ç¨‹ååŠpid"><meta property="og:type" content="article"><meta property="og:url" content="http://houugen.fun/posts/ios-hook-fridadev.html"><meta property="article:published_time" content="2018-11-30T09:52:00+00:00"><meta property="article:modified_time" content="2018-11-30T09:52:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="iOS Hook FridaDev"><meta name=twitter:description content="FridaDev ä½œä¸ºå¤§è‡ªç„¶çš„æ¬è¿å·¥å’Œç»„è£…å¸ˆå‚…ï¼Œæ”¶é›†å¹¶å¢å¼ºä¸€äº›éå¸¸æœ‰ç”¨çš„fridaè„šæœ¬å°è£…ä¸ºFridaDevå·¥å…·ï¼Œå¯ä»¥å®ç°ä¸€é”®å¼é€†å‘éœ€æ±‚ï¼Œæé«˜ç”Ÿäº§åŠ›ã€‚
è„šæœ¬æ¥æºï¼š
 https://github.com/0xdea/frida-scripts https://github.com/AloneMonkey/iOSREBook/tree/master/chapter-7/7.3%20Frida%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/Frida  ä¿®æ”¹ï¼š
 åŠ¨æ€hook uiå¢åŠ æ‰“å°controllerå’Œaction æ ¹æ®ç¨³å®šæ€§traceé€‰æ‹©spwanï¼Œå…¶ä»–åŠŸèƒ½é€‰æ‹©attach  ä»“åº“ç›´é€šè½¦ï¼šhttps://github.com/houugen/FridaDev
åŠŸèƒ½ usage: fridaDev.py [-h] [-l] [-i] [-u appName] [-d appName] [-t identifier] [-e identifier] frida tools optional arguments: -h, --help show this help message and exit -l, --list list running processes -i, --info list installed app infomation -u appName, --ui appName show UI (only for ios) -d appName, --dynhook appName dynamic hook -t identifier, --trace identifier ObjC/java and Module tracer -e identifier, --enumerate identifier Collection of functions to enumerate classes and list åŠŸèƒ½ï¼šåˆ—å‡ºè¿è¡Œè¿›ç¨‹ååŠpid"><meta name=application-name content><meta name=apple-mobile-web-app-title content><link rel="shortcut icon" type=image/x-icon href=../favicon.ico><link rel=icon type=image/png sizes=32x32 href=../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=../apple-touch-icon.png><link rel=manifest href=../site.webmanifest><link rel=canonical href=http://houugen.fun/posts/ios-hook-fridadev.html><link rel=prev href=http://houugen.fun/posts/ios%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0.html><link rel=next href=http://houugen.fun/posts/blockchain-security-articles.html><link rel=stylesheet href=../lib/normalize/normalize.min.css><link rel=stylesheet href=../css/style.min.css><link rel=stylesheet href=../lib/fontawesome-free/all.min.css><link rel=stylesheet href=../lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"iOS Hook FridaDev","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/houugen.fun\/posts\/ios-hook-fridadev.html"},"genre":"posts","keywords":"iOS, Frida","wordcount":1612,"url":"http:\/\/houugen.fun\/posts\/ios-hook-fridadev.html","datePublished":"2018-11-30T09:52:00+00:00","dateModified":"2018-11-30T09:52:00+00:00","publisher":{"@type":"Organization","name":"Houugen"},"author":{"@type":"Person","name":"Houugen"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=../>Houugen<span class=header-title-post>ãƒ¢ãƒ–</span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=../posts/>Posts </a><a class=menu-item href=../tags/>Tags </a><a class=menu-item href=../categories/>Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=../>Houugen<span class=header-title-post>ãƒ¢ãƒ–</span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=../posts/>Posts</a><a class=menu-item href=../tags/>Tags</a><a class=menu-item href=../categories/>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">iOS Hook FridaDev</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=../ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Houugen</a></span>&nbsp;<span class=post-category>included in <a href=../categories/ios.html><i class="far fa-folder fa-fw"></i>iOS</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2018-11-30>2018-11-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1612 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;8 minutes&nbsp;<span id=/posts/ios-hook-fridadev.html class=leancloud_visitors data-flag-title="iOS Hook FridaDev">
<i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
</span>&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#fridadev>FridaDev</a><ul><li><a href=#åŠŸèƒ½>åŠŸèƒ½</a></li><li><a href=#å®ä¾‹>å®ä¾‹</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=fridadev>FridaDev</h2><p>ä½œä¸ºå¤§è‡ªç„¶çš„æ¬è¿å·¥å’Œç»„è£…å¸ˆå‚…ï¼Œæ”¶é›†å¹¶å¢å¼ºä¸€äº›éå¸¸æœ‰ç”¨çš„fridaè„šæœ¬å°è£…ä¸ºFridaDevå·¥å…·ï¼Œå¯ä»¥å®ç°ä¸€é”®å¼é€†å‘éœ€æ±‚ï¼Œæé«˜ç”Ÿäº§åŠ›ã€‚</p><p>è„šæœ¬æ¥æºï¼š</p><ul><li><a href=https://github.com/0xdea/frida-scripts target=_blank rel="noopener noreffer">https://github.com/0xdea/frida-scripts</a></li><li><a href=https://github.com/AloneMonkey/iOSREBook/tree/master/chapter-7/7.3%20Frida%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/Frida target=_blank rel="noopener noreffer">https://github.com/AloneMonkey/iOSREBook/tree/master/chapter-7/7.3%20Frida%E5%AE%9E%E6%88%98%E5%BA%94%E7%94%A8/Frida</a></li></ul><p>ä¿®æ”¹ï¼š</p><ul><li>åŠ¨æ€hook</li><li>uiå¢åŠ æ‰“å°controllerå’Œaction</li><li>æ ¹æ®ç¨³å®šæ€§traceé€‰æ‹©spwanï¼Œå…¶ä»–åŠŸèƒ½é€‰æ‹©attach</li></ul><p><strong>ä»“åº“ç›´é€šè½¦</strong>ï¼š<a href=https://github.com/houugen/FridaDev target=_blank rel="noopener noreffer">https://github.com/houugen/FridaDev</a></p><h3 id=åŠŸèƒ½>åŠŸèƒ½</h3><pre><code>usage: fridaDev.py [-h] [-l] [-i] [-u appName] [-d appName] [-t identifier]
                   [-e identifier]

frida tools

optional arguments:
  -h, --help            show this help message and exit
  -l, --list            list running processes
  -i, --info            list installed app infomation
  -u appName, --ui appName
                        show UI (only for ios)
  -d appName, --dynhook appName
                        dynamic hook
  -t identifier, --trace identifier
                        ObjC/java and Module tracer
  -e identifier, --enumerate identifier
                        Collection of functions to enumerate classes and
</code></pre><h4 id=list>list</h4><p>åŠŸèƒ½ï¼šåˆ—å‡ºè¿è¡Œè¿›ç¨‹ååŠpid</p><p>ä½¿ç”¨ï¼ˆæ”¯æŒgrepï¼‰ï¼š</p><div class=highlight><pre class=chroma><code class=language-cmd data-lang=cmd>./fridaDev.py -l (<span class=p>|</span> grep xxx)`

[*] Device info: Device(id=<span class=s2>&#34;83ae210b1d153c611e268b45b54e5f77d575212b&#34;</span>, name=<span class=s2>&#34;iPhone&#34;</span>, type=&#39;usb&#39;)

pid   	name
0     	launchd
1     	launchd
179   	amfid
346   	jailbreakd
491   	wifid
...
</code></pre></div><h4 id=info>info</h4><p>åŠŸèƒ½ï¼šåˆ—å‡ºå·²è£…åº”ç”¨çš„åº”ç”¨åã€bundleIdåŠæ²™ç›’è·¯å¾„</p><p>ä½¿ç”¨ï¼ˆæ”¯æŒgrepï¼‰ï¼š</p><div class=highlight><pre class=chroma><code class=language-cmd data-lang=cmd>./fridaDev.py -i (<span class=p>|</span> grep xxx)

[*] Device info: Device(id=<span class=s2>&#34;83ae210b1d153c611e268b45b54e5f77d575212b&#34;</span>, name=<span class=s2>&#34;iPhone&#34;</span>, type=&#39;usb&#39;)

app name                                	bundle identify                                             	documents path
undefinedQQæµè§ˆå™¨                          	com.tencent.mttlite                                         	file:///private/var/mobile/Containers/Data/Application/0F2137C5-52EC-4C44-9247-9D1E2666AE0C/Documents
è®¡ç®—å™¨                                     	com.apple.calculator                                        	file:///private/var/mobile/Containers/Data/Application/4A593BCE-1460-4785-BC18-18DFAF5BFFBA/Documents
é€šè®¯å½•                                     	com.apple.MobileAddressBook                                 	file:///private/var/mobile/Containers/Data/Application/F8C2EB38-1FBE-415B-B562-C910589F66FE/Documents
å’ªå’•å–„è·‘                                    	org.imohoo.shanpao                                          	file:///private/var/mobile/Containers/Data/Application/0FC0A9BF-958C-4BCD-9AF0-5680B414A853/Documents
</code></pre></div><h4 id=uiä»…æ”¯æŒios>uiï¼ˆä»…æ”¯æŒiOSï¼‰</h4><p>åŠŸèƒ½ï¼šdump iOSç•Œé¢å¸ƒå±€ï¼Œæ”¯æŒæ‰“å°nextResponderã€controlleråŠaction</p><p>ä½¿ç”¨ï¼š</p><ol><li>æ‰“å¼€éœ€è¦dumpçš„åº”ç”¨ç•Œé¢</li><li><code>./fridaDev.py -u appName</code><ul><li>æ‰“å°å“åº”é“¾nextResponderï¼š n 0x144f6e6c0</li><li>æ‰“å°controllerï¼š c 0x144f6e6c0</li><li>æ‰“å°actionï¼š a 0x144f6e6c0</li></ul></li></ol><div class=highlight><pre class=chroma><code class=language-c++ data-lang=c++><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Device</span> <span class=nl>info</span><span class=p>:</span> <span class=n>Device</span><span class=p>(</span><span class=n>id</span><span class=o>=</span><span class=s>&#34;83ae210b1d153c611e268b45b54e5f77d575212b&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s>&#34;iPhone&#34;</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=err>&#39;</span><span class=n>usb</span><span class=err>&#39;</span><span class=p>)</span>

<span class=o>&lt;</span><span class=nl>UIWindow</span><span class=p>:</span> <span class=mh>0x146007e40</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x146009290</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>UIWindowLayer</span><span class=p>:</span> <span class=mh>0x146007dc0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UILayoutContainerView</span><span class=p>:</span> <span class=mh>0x144d629d0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x14602c450</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144d63ac0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UINavigationTransitionView</span><span class=p>:</span> <span class=mh>0x146026be0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>clipsToBounds</span> <span class=o>=</span> <span class=n>YES</span><span class=p>;</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x146023cf0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIViewControllerWrapperView</span><span class=p>:</span> <span class=mh>0x144f6fd50</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f6f2e0</span><span class=o>&gt;&gt;</span>

<span class=p>...</span>

   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>FireflyButton</span><span class=p>:</span> <span class=mh>0x144f6e6c0</span><span class=p>;</span> <span class=n>baseClass</span> <span class=o>=</span> <span class=n>UIButton</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>38</span> <span class=mf>120.5</span><span class=p>;</span> <span class=mi>183</span> <span class=mi>34</span><span class=p>);</span> <span class=n>clipsToBounds</span> <span class=o>=</span> <span class=n>YES</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f6d690</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIButtonLabel</span><span class=p>:</span> <span class=mh>0x1460665c0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mf>73.5</span> <span class=mf>6.5</span><span class=p>;</span> <span class=mi>36</span> <span class=mf>21.5</span><span class=p>);</span> <span class=n>text</span> <span class=o>=</span> <span class=err>&#39;ç™»å½•&#39;</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>_UILabelLayer</span><span class=p>:</span> <span class=mh>0x1460667e0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UILabelContentLayer</span><span class=p>:</span> <span class=mh>0x144f67e20</span><span class=o>&gt;</span> <span class=p>(</span><span class=n>layer</span><span class=p>)</span>
   <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UINavigationBar</span><span class=p>:</span> <span class=mh>0x144da8880</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>20</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>44</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=p>;</span> <span class=n>tintColor</span> <span class=o>=</span> <span class=n>UIDeviceWhiteColorSpace</span> <span class=mi>1</span> <span class=mi>1</span><span class=p>;</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x14602ddd0</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x1460279d0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UINavigationBarBackground</span><span class=p>:</span> <span class=mh>0x146026f60</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=o>-</span><span class=mi>20</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>64</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x14602b8b0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x144db8f10</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>64</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>0</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x146023e00</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UINavigationBarBackIndicatorView</span><span class=p>:</span> <span class=mh>0x14602cab0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>8</span> <span class=mf>11.5</span><span class=p>;</span> <span class=mi>13</span> <span class=mi>21</span><span class=p>);</span> <span class=n>alpha</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144da7510</span><span class=o>&gt;&gt;</span>
<span class=o>&lt;</span><span class=n>CSNavJViewController</span> <span class=mh>0x1450fe000</span><span class=o>&gt;</span><span class=p>,</span> <span class=nl>state</span><span class=p>:</span> <span class=n>appeared</span><span class=p>,</span> <span class=nl>view</span><span class=p>:</span> <span class=o>&lt;</span><span class=n>UILayoutContainerView</span> <span class=mh>0x144d629d0</span><span class=o>&gt;</span>
   <span class=o>|</span> <span class=o>&lt;</span><span class=n>FireflyTestLoginViewController</span> <span class=mh>0x144f37c30</span><span class=o>&gt;</span><span class=p>,</span> <span class=nl>state</span><span class=p>:</span> <span class=n>appeared</span><span class=p>,</span> <span class=nl>view</span><span class=p>:</span> <span class=o>&lt;</span><span class=n>UIView</span> <span class=mh>0x14602d3a0</span><span class=o>&gt;</span>
<span class=n>a</span> <span class=mh>0x144f6e6c0</span>
<span class=o>-&gt;</span> <span class=n>loginButtonClick</span>
<span class=n>c</span> <span class=mh>0x144f6e6c0</span>
<span class=o>-&gt;</span> <span class=o>&lt;</span><span class=nl>FireflyTestLoginViewController</span><span class=p>:</span> <span class=mh>0x144f37c30</span><span class=o>&gt;</span>
<span class=n>n</span> <span class=mh>0x144f6e6c0</span>
<span class=o>-&gt;&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x144f33530</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mf>30.5</span> <span class=mf>145.5</span><span class=p>;</span> <span class=mi>259</span> <span class=mi>189</span><span class=p>);</span> <span class=n>alpha</span> <span class=o>=</span> <span class=mf>0.8</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f03d00</span><span class=o>&gt;&gt;</span>
<span class=o>--&gt;&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x144f390a0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f24d10</span><span class=o>&gt;&gt;</span>
<span class=o>---&gt;&lt;</span><span class=nl>UIView</span><span class=p>:</span> <span class=mh>0x14602d3a0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144d49060</span><span class=o>&gt;&gt;</span>
<span class=o>----&gt;&lt;</span><span class=nl>FireflyTestLoginViewController</span><span class=p>:</span> <span class=mh>0x144f37c30</span><span class=o>&gt;</span>
<span class=o>-----&gt;&lt;</span><span class=nl>UIViewControllerWrapperView</span><span class=p>:</span> <span class=mh>0x144f6fd50</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f6f2e0</span><span class=o>&gt;&gt;</span>
<span class=p>...</span>

</code></pre></div><h4 id=dynhook>dynhook</h4><p>åŠŸèƒ½ï¼šhookå¯¹åº”å‡½æ•°ï¼Œåšä½ æ‰€æƒ³</p><p>è¯´æ˜ï¼šandroid Hookä»£ç å†™å…¥<code>android_hook.js</code>ï¼ŒiOS Hookä»£ç å†™å…¥<code>ios_hook.js</code>ï¼Œè„šæœ¬è‡ªè¡Œåˆ¤æ–­å¹³å°ã€‚</p><p>ä½¿ç”¨ï¼š</p><div class=highlight><pre class=chroma><code class=language-cmd data-lang=cmd>./fridaDev.py -d appName

[*] Device info: Device(id=<span class=s2>&#34;83ae210b1d153c611e268b45b54e5f77d575212b&#34;</span>, name=<span class=s2>&#34;iPhone&#34;</span>, type=&#39;usb&#39;)

[+] killing 36988
[-] xxx is not found...
[+] Injecting script to xxx(37079)
+[FireflySecurityUtil aesEncryptğŸ”‘vector:] onEnter...
+[FireflySecurityUtil aesEncryptğŸ”‘vector:] onLeave...
ret: nil
</code></pre></div><h4 id=trace>trace</h4><p>åŠŸèƒ½ï¼šè¿½è¸ªå‡½æ•°è°ƒç”¨ï¼Œæ‰“å°è¾“å…¥è¾“å‡º</p><p>è¯´æ˜ï¼šandroid traceä¿®æ”¹<code>android_trace.js</code>ï¼ŒiOS traceä¿®æ”¹<code>ios_trace.js</code>ï¼Œè„šæœ¬è‡ªè¡Œåˆ¤æ–­å¹³å°ã€‚ <strong>æ”¯æŒæ­£åˆ™ï¼Œå¯ä»¥å‘æŒ¥ä½ çš„æƒ³è±¡åŠ›</strong>ã€‚</p><p>ä¿®æ”¹å¦‚ä¸‹å†…å®¹ï¼š</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=c1>// usage examples
</span><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=nx>ObjC</span><span class=p>.</span><span class=nx>available</span><span class=p>)</span> <span class=p>{</span>
	<span class=nx>trace</span><span class=p>(</span><span class=s2>&#34;-[FireflyTestLoginViewController loginButtonClick]&#34;</span><span class=p>)</span>
	<span class=c1>// trace(&#34;-[FireflyTestLoginViewController *]&#34;)
</span><span class=c1></span>	<span class=nx>trace</span><span class=p>(</span><span class=s2>&#34;*[* *ncrypt*]&#34;</span><span class=p>);</span>
	<span class=c1>// trace(&#34;exports:libSystem.B.dylib!CCCrypt&#34;);
</span><span class=c1></span>	<span class=c1>// trace(&#34;exports:libSystem.B.dylib!open&#34;);
</span><span class=c1></span>	<span class=c1>// trace(&#34;exports:*!open*&#34;);
</span><span class=c1></span>	
<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
 	<span class=nx>send</span><span class=p>(</span><span class=s2>&#34;error: Objective-C Runtime is not available!&#34;</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p>ä½¿ç”¨ï¼š</p><div class=highlight><pre class=chroma><code class=language-cmd data-lang=cmd>./fridaDev.py -t bundleId

[iPhone::com.lzm.khjlHack]-&gt;
*** entered -[FireflyTestLoginViewController viewDidLoad]

Caller: 0x1840de580 CoreFoundation!__invoking___

*** entered -[FireflyTestLoginViewController setIsBool:]

Caller: 0x1840de580 CoreFoundation!__invoking___

setIsBool: nil

retval: <span class=p>&lt;</span>FireflyTestLoginViewController: 0x12de4a180&gt;

*** exiting -[FireflyTestLoginViewController setIsBool:]

*** entered -[FireflyTestLoginViewController initViews]

Caller: 0x1840de580 CoreFoundation!__invoking___

*** entered -[FireflyTestLoginViewController BackIamgeViewUI]

Caller: 0x1840de580 CoreFoundation!__invoking___

retval: <span class=p>&lt;</span>UIView: 0x12de3b400; frame = (0 0; 320 480); autoresize = W+H; layer = <span class=p>&lt;</span>CALayer: 0x1c02292a0<span class=p>&gt;</span>&gt;

*** exiting -[FireflyTestLoginViewController BackIamgeViewUI]

...
</code></pre></div><h4 id=enumerate>enumerate</h4><p>åŠŸèƒ½ï¼šæšä¸¾æ‰€æœ‰ç±»ã€æ‰€æœ‰æ–¹æ³•ã€ä¸€ä¸ªç±»çš„æ‰€æœ‰æ–¹æ³•ã€åŒ¹é…æ­£åˆ™çš„æ‰€æœ‰ç±»ã€åŒ¹é…æ­£åˆ™çš„æ‰€æœ‰æ–¹æ³•</p><p>è¯´æ˜ï¼šandroid enumerateä¿®æ”¹<code>android_enum.js</code>ï¼ŒiOS enumerateä¿®æ”¹<code>ios_enum.js</code>ï¼Œè„šæœ¬è‡ªè¡Œåˆ¤æ–­å¹³å°ã€‚ <strong>æ”¯æŒæ­£åˆ™ï¼Œå¯ä»¥å‘æŒ¥ä½ çš„æƒ³è±¡åŠ›</strong>ã€‚</p><p>ä¿®æ”¹å¦‚ä¸‹å†…å®¹ï¼š</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=c1>// usage examples
</span><span class=c1></span><span class=k>if</span> <span class=p>(</span><span class=nx>ObjC</span><span class=p>.</span><span class=nx>available</span><span class=p>)</span> <span class=p>{</span>

	<span class=c1>// enumerate all classes
</span><span class=c1></span>	<span class=cm>/*
</span><span class=cm>	var a = enumAllClasses();
</span><span class=cm>	a.forEach(function(s) { 
</span><span class=cm>		console.log(s); 
</span><span class=cm>	});
</span><span class=cm>	*/</span>

	<span class=c1>// find classes that match a pattern
</span><span class=c1></span>	<span class=cm>/*
</span><span class=cm>	var a = findClasses(/FireflySecurityUtil/i);
</span><span class=cm>	a.forEach(function(s) { 
</span><span class=cm>		console.log(s); 
</span><span class=cm>	});
</span><span class=cm>	*/</span>

	<span class=c1>// enumerate all methods in a class
</span><span class=c1></span>	<span class=cm>/*
</span><span class=cm>	var a = enumMethods(&#34;CGBLoginViewController&#34;)
</span><span class=cm>	a.forEach(function(s) { 
</span><span class=cm>		console.log(s); 
</span><span class=cm>	});
</span><span class=cm>	*/</span>

	<span class=c1>// enumerate all methods
</span><span class=c1></span>	<span class=cm>/*
</span><span class=cm>	var d = enumAllMethods();
</span><span class=cm>	for (k in d) {
</span><span class=cm>		console.log(k);
</span><span class=cm>		d[k].forEach(function(s) {
</span><span class=cm>			console.log(&#34;\t&#34; + s);
</span><span class=cm>		});
</span><span class=cm>	}
</span><span class=cm>	*/</span>

	<span class=c1>// find methods that match a pattern
</span><span class=c1></span>	
	<span class=kd>var</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>findMethods</span><span class=p>(</span><span class=sr>/encrypt|decrypt/i</span><span class=p>);</span>
	<span class=k>for</span> <span class=p>(</span><span class=nx>k</span> <span class=k>in</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
		<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>k</span><span class=p>);</span>
		<span class=nx>d</span><span class=p>[</span><span class=nx>k</span><span class=p>].</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=p>{</span>
			<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;\t&#34;</span> <span class=o>+</span> <span class=nx>s</span><span class=p>);</span>
		<span class=p>});</span>
	<span class=p>}</span>
<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
 	<span class=nx>send</span><span class=p>(</span><span class=s2>&#34;error: Objective-C Runtime is not available!&#34;</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p>ä½¿ç”¨ï¼š</p><div class=highlight><pre class=chroma><code class=language-cmd data-lang=cmd>./fridaDev.py -e bundleId

[*] Device info: Device(id=<span class=s2>&#34;83ae210b1d153c611e268b45b54e5f77d575212b&#34;</span>, name=<span class=s2>&#34;iPhone&#34;</span>, type=&#39;usb&#39;)

CMBCStandardiOSSipKeyboardVC
	- setNeedEncrypt:
	- getEncryptedDataWithError:
	- needEncrypt
	- initWithKeyboardType:needEncrypt:
FireflySecurityUtil
	+ qhd_FireflyRSAEncrypt:cerPath:
	+ qhd_FireflyRSAEncrypt:publicKey:
	+ qhd_aesDecryptğŸ”‘vector:
	+ qhd_aesEncryptğŸ”‘vector:
	+ aesEncryptğŸ”‘vector:
	+ aesDecryptğŸ”‘vector:
	+ FireflyRSAEncrypt:publicKey:
	+ FireflyRSAEncrypt:cerPath:
CMCCSafeManager
	- getEncryptCode:
	- decryptCode:
	- getDecryptCode:
	- encryptCode:
	- encryptWithContent:
	- decryptWithContent:
FaceResult
	- encryptRandom
	- setEncryptRandom:

...
</code></pre></div><h3 id=å®ä¾‹>å®ä¾‹</h3><p>ä»¥æŸappä¸ºä¾‹ä»‹ç»å·¥å…·ä½¿ç”¨ã€‚</p><p>ç™»å½•ç•Œé¢</p><p><img class=lazyload src=../svg/loading.min.svg data-src=iOS-Hook-FridaDev/2.png data-srcset="iOS-Hook-FridaDev/2.png, iOS-Hook-FridaDev/2.png 1.5x, iOS-Hook-FridaDev/2.png 2x" data-sizes=auto alt=iOS-Hook-FridaDev/2.png title=iOS-Hook-FridaDev/2.png></p><p>ç™»å½•æ•°æ®åŒ…åŠ å¯†
<img class=lazyload src=../svg/loading.min.svg data-src=iOS-Hook-FridaDev/1.png data-srcset="iOS-Hook-FridaDev/1.png, iOS-Hook-FridaDev/1.png 1.5x, iOS-Hook-FridaDev/1.png 2x" data-sizes=auto alt=iOS-Hook-FridaDev/1.png title=iOS-Hook-FridaDev/1.png></p><p>ç°åœ¨éœ€è¦ç ´è§£åŠ è§£å¯†ï¼Œåˆ†ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>çŒœè§£åŠ è§£å¯†å…³é”®å­—å®šä½åŠ è§£å¯†å‡½æ•°</li><li>æ­£å‘åˆ†æç™»å½•åŠŸèƒ½æ‰¾åˆ°åŠ è§£å¯†é€»è¾‘</li></ol><h4 id=çŒœè§£>çŒœè§£</h4><p>çŒœè§£çš„æ–¹å¼å­˜åœ¨å¶ç„¶æ€§ï¼Œä¸é‡‡ç”¨æ ‡å‡†åº“åŠ å¯†æˆ–å¸¸è§„åŠ è§£å¯†å‘½åçš„å°±å¾ˆéš¾æ‰¾åˆ°ã€‚</p><p>æˆ‘ä»¬å°è¯•ä½¿ç”¨fridaDevçš„<code>--enumerate</code>åŠŸèƒ½æšä¸¾åŠ è§£å¯†é€»è¾‘ï¼Œä¿®æ”¹<code>ios_enum.js</code>ä¸­çš„æ­£åˆ™åŒ¹é…æšä¸¾æ–¹æ³•å¤„ä»£ç ï¼Œæ­£åˆ™ä¸­ä¿®æ”¹ä¸º<code>encrypt|decrypt</code>.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=kd>var</span> <span class=nx>d</span> <span class=o>=</span> <span class=nx>findMethods</span><span class=p>(</span><span class=sr>/encrypt|decrypt/i</span><span class=p>);</span>
<span class=k>for</span> <span class=p>(</span><span class=nx>k</span> <span class=k>in</span> <span class=nx>d</span><span class=p>)</span> <span class=p>{</span>
	<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>k</span><span class=p>);</span>
	<span class=nx>d</span><span class=p>[</span><span class=nx>k</span><span class=p>].</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=p>{</span>
		<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;\t&#34;</span> <span class=o>+</span> <span class=nx>s</span><span class=p>);</span>
	<span class=p>});</span>
<span class=p>}</span>
</code></pre></div><p>è¿è¡Œè„šæœ¬æŸ¥çœ‹è¾“å‡º</p><pre><code>[*] Device info: Device(id=&quot;83ae210b1d153c611e268b45b54e5f77d575212b&quot;, name=&quot;iPhone&quot;, type='usb')

CMBCStandardiOSSipKeyboardVC
    - setNeedEncrypt:
    - getEncryptedDataWithError:
    - needEncrypt
    - initWithKeyboardType:needEncrypt:
FireflySecurityUtil
    + qhd_FireflyRSAEncrypt:cerPath:
    + qhd_FireflyRSAEncrypt:publicKey:
    + qhd_aesDecryptğŸ”‘vector:
    + qhd_aesEncryptğŸ”‘vector:
    + aesEncryptğŸ”‘vector:
    + aesDecryptğŸ”‘vector:
    + FireflyRSAEncrypt:publicKey:
    + FireflyRSAEncrypt:cerPath:
CMCCSafeManager
    - getEncryptCode:
    - decryptCode:
    - getDecryptCode:
    - encryptCode:
    - encryptWithContent:
    - decryptWithContent:
...
</code></pre><p>é€šè¿‡æŒ¨ä¸ªæ’æŸ¥æˆ–è€…ä½ dumpäº†ç•Œé¢UIçŸ¥é“viewçš„controllerç±»åï¼Œå…¶å®å·²ç»åŸºæœ¬èƒ½çŒœæµ‹è°ƒç”¨å“ªäº›ç›¸å…³åŠ è§£å¯†å‡½æ•°ã€‚</p><p>å¦‚æœä½ è¿˜æ˜¯ä¸ç¡®å®šå“ªä¸ªç±»é‡Œçš„é‚£ä¸ªæ–¹æ³•è¢«è°ƒç”¨ï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä»¬é€šè¿‡traceåŠŸèƒ½è¿½è¸ªå‡½æ•°è°ƒç”¨æ¥ç¡®å®šå…·ä½“ä½¿ç”¨å“ªä¸ªæ–¹æ³•ã€‚</p><p>ä¿®æ”¹<code>ios_trace.js</code>å°¾éƒ¨ä»£ç ï¼š</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=k>if</span> <span class=p>(</span><span class=nx>ObjC</span><span class=p>.</span><span class=nx>available</span><span class=p>)</span> <span class=p>{</span>
	<span class=nx>trace</span><span class=p>(</span><span class=s2>&#34;*[CMBCStandardiOSSipKeyboardVC *]&#34;</span><span class=p>);</span>
	<span class=nx>trace</span><span class=p>(</span><span class=s2>&#34;*[FireflySecurityUtil *]&#34;</span><span class=p>);</span>
	<span class=nx>trace</span><span class=p>(</span><span class=s2>&#34;*[CMCCSafeManager *]&#34;</span><span class=p>);</span>
<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
 	<span class=nx>send</span><span class=p>(</span><span class=s2>&#34;error: Objective-C Runtime is not available!&#34;</span><span class=p>);</span>
<span class=p>}</span>
</code></pre></div><p>è¿è¡Œä»£ç åå¯åŠ¨åº”ç”¨ï¼Œç‚¹å‡»ç™»å½•æŸ¥çœ‹æ­¤å¤„logï¼š</p><pre><code>...

*** entered +[FireflySecurityUtil FireflyRSAEncrypt:publicKey:]

Caller: 0x1840de580 CoreFoundation!__invoking___

FireflyRSAEncrypt: {&quot;flag&quot;:&quot;0&quot;,&quot;ckey&quot;:&quot;AZWKLXOMREDGAKPMTIBHTKOBRVGKNBHC&quot;}
publicKey: MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDFV+0lKbisYcFxEaalfN4DMc14fMVTZTFZB1X4MoZtEu6lFpVvmSZT4eaSgp1Vxol8HSsqFncxxtv/GXpqJ3kY1DghafKliSFfTkV1PYoHKGoUYVdwt/HubzQBcC3xh+xiZvspBWy4Bjal//HoHrBBN05R2ZFnU9obS4Xw+jKbOQIDAQAB

*** entered +[FireflySecurityUtil stripPublicKeyHeader:]

Caller: 0x1840de580 CoreFoundation!__invoking___

stripPublicKeyHeader: &lt;30819f30 0d06092a 864886f7 0d010101 05000381 8d003081 89028181 00c557ed 2529b8ac 61c17111 a6a57cde 0331cd78 7cc55365 31590755 f832866d 12eea516 956f9926 53e1e692 829d55c6 897c1d2b 2a167731 c6dbff19 7a6a2779 18d43821 69f2a589 215f4e45 753d8a07 286a1461 5770b7f1 ee6f3401 702df187 ec6266fb 29056cb8 0636a5ff f1e81eb0 41374e51 d9916753 da1b4b85 f0fa329b 39020301 0001&gt;

retval: &lt;30818902 818100c5 57ed2529 b8ac61c1 7111a6a5 7cde0331 cd787cc5 53653159 0755f832 866d12ee a516956f 992653e1 e692829d 55c6897c 1d2b2a16 7731c6db ff197a6a 277918d4 382169f2 a589215f 4e45753d 8a07286a 14615770 b7f1ee6f 3401702d f187ec62 66fb2905 6cb80636 a5fff1e8 1eb04137 4e51d991 6753da1b 4b85f0fa 329b3902 03010001&gt;

*** exiting +[FireflySecurityUtil stripPublicKeyHeader:]

retval: NrbG9/JxK65OMfl9WsFmCYU5Xfr1Av6Q/XOulxeoDc5CSf2AajFgE3CSH6MVHD3YlqCq4/Z20PevpakS1LMjsIpiywsOsrrfDESr87ATJ3Ta4TuGfg7ooLwAbUVHh77a4ZJInEaz63cpZuviy5b/fsftGjqllWtqxATNjU3dRBI=

*** exiting +[FireflySecurityUtil FireflyRSAEncrypt:publicKey:]

*** entered +[FireflySecurityUtil isJailBreak]

Caller: 0x1840de580 CoreFoundation!__invoking___

retval: 0x1

*** exiting +[FireflySecurityUtil isJailBreak]

...

*** entered -[FireflySecurityUtil aesToken]

Caller: 0x1840de580 CoreFoundation!__invoking___

retval: AZWKLXOMREDGAKPM5pblzNXaVqAXmBwl

*** exiting -[FireflySecurityUtil aesToken]

*** entered +[FireflySecurityUtil aesEncryptğŸ”‘vector:]

Caller: 0x1840de580 CoreFoundation!__invoking___

aesEncrypt: {&quot;secRan&quot;:&quot;W9zvEM&quot;,&quot;staffId&quot;:&quot;F&quot;,&quot;password&quot;:&quot;NmQk8hKN9Sn1UTQha4JnAxYnfJiUGdwTw+Lws9rWHhsXgBt2ZARjOfrxH3Ka166Wias83OROXYjof6NvZ9zMJaKAP1NBPsiWZEE7gkRDlpCKwR\/AVMwOzA4xAFcb7WKWIWrJg7NjpsvMvsjxzqxx\/2sR4zglTx8P6jpHWigCEf0=&quot;,&quot;imeiCode&quot;:&quot;3823ACEE-A647-46F8-8D14-8065E5C2B0C6&quot;,&quot;validateImgCode&quot;:&quot;&quot;}
key: AZWKLXOMREDGAKPM5pblzNXaVqAXmBwl
vector: 1234567812345678

retval: yUF8H3QiqR21mTIrNxTTRtNx4l2IAyJ6AT0r7ATs9vO5MgYCahUT3qRxrT+qWDhyDD2znN5t1esauWYHPt+2AAd4NrfcYVs/QPMOstjpGcp4wey1HssAYNk2OtAKz5lRo6Bnw8CFiKMWdpdBS5Y4/G80irK0Dq12oPc52I956UtP3zCFNqE2rfQFZqcd35FA0CajccT5Ny6v/qKoScApnTLBmTKMmj3na+PTzyIOLXr1ObjwY9C+Snygf4xzb9AEU73WbIjxhsfdG6m3mEGrugw8Gn3nj/Eqb3mREUkvsQMt9FezDd4PWnJTRM6r6D5S5WI7ACYJU8kYDF0VK4H0Ixpe+xNoLdtYabgtcoSd9zkTFADW/SY6JzJaa6BwHpWoBeOree/dRgr6xyA8H4Zphw==

*** exiting +[FireflySecurityUtil aesEncryptğŸ”‘vector:]

...
</code></pre><p>å¯ä»¥çœ‹åˆ°ç‚¹å‡»ç™»å½•åè°ƒç”¨<code>+[FireflySecurityUtil FireflyRSAEncrypt:publicKey:]</code>å¯¹cKeyåŠ å¯†ï¼Œè°ƒç”¨<code>+[FireflySecurityUtil aesEncryptğŸ”‘vector:]</code>å¯¹è¯·æ±‚æ•°æ®è¿›è¡ŒaesåŠ å¯†ï¼ŒæˆåŠŸå®šä½æ•°æ®åŠ è§£å¯†å‡½æ•°ã€‚</p><p>ä½ ç”šè‡³å¯ä»¥ç›´æ¥åœ¨traceä»£ç ä¸­å†™:</p><pre><code>trace(&quot;*[ *ncrypt*]&quot;);
</code></pre><p>åŒæ ·å¯ä»¥åŠ¨æ€å®šä½åŠ å¯†å‡½æ•°ã€‚</p><h4 id=æ­£å‘åˆ†æ>æ­£å‘åˆ†æ</h4><p>ä»ç•Œé¢å…¥æ‰‹æ‰¾åˆ°ç™»å½•viewå¯¹åº”çš„controllerï¼Œæˆ–è€…ç™»å½•buttonå¯¹åº”çš„actionï¼Œå¯ä»¥é€šè¿‡cycriptæˆ–è€…lldbæ–¹å¼:</p><p><img class=lazyload src=../svg/loading.min.svg data-src=iOS-Hook-FridaDev/3.png data-srcset="iOS-Hook-FridaDev/3.png, iOS-Hook-FridaDev/3.png 1.5x, iOS-Hook-FridaDev/3.png 2x" data-sizes=auto alt=iOS-Hook-FridaDev/3.png title=iOS-Hook-FridaDev/3.png></p><p>ä½†æ˜¯æˆ‘ä»¬ç°åœ¨ä½¿ç”¨fridaDevæ¥ç¡®å®šç™»å½•é€»è¾‘å…¥å£</p><p>é¦–å…ˆä½¿ç”¨fridaDevçš„uiåŠŸèƒ½dumpé¡µé¢ï¼Œé€šè¿‡ç™»å½•buttonæ‰¾åˆ°å¯¹åº”actionã€‚</p><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=p>[</span><span class=o>*</span><span class=p>]</span> <span class=n>Device</span> <span class=nl>info</span><span class=p>:</span> <span class=n>Device</span><span class=p>(</span><span class=n>id</span><span class=o>=</span><span class=s>&#34;33010c846ea011df002c0781f922a10c9f2aca48&#34;</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s>&#34;iPad 4&#34;</span><span class=p>,</span> <span class=n>type</span><span class=o>=</span><span class=err>&#39;</span><span class=n>usb</span><span class=err>&#39;</span><span class=p>)</span>

<span class=o>&lt;</span><span class=nl>UIWindow</span><span class=p>:</span> <span class=mh>0x146007e40</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x146009290</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>UIWindowLayer</span><span class=p>:</span> <span class=mh>0x146007dc0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UILayoutContainerView</span><span class=p>:</span> <span class=mh>0x144d629d0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x14602c450</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144d63ac0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UINavigationTransitionView</span><span class=p>:</span> <span class=mh>0x146026be0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>clipsToBounds</span> <span class=o>=</span> <span class=n>YES</span><span class=p>;</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x146023cf0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIViewControllerWrapperView</span><span class=p>:</span> <span class=mh>0x144f6fd50</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f6f2e0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIView</span><span class=p>:</span> <span class=mh>0x14602d3a0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=o>+</span><span class=n>H</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144d49060</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x144f390a0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>480</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f24d10</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x144f33530</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mf>30.5</span> <span class=mf>145.5</span><span class=p>;</span> <span class=mi>259</span> <span class=mi>189</span><span class=p>);</span> <span class=n>alpha</span> <span class=o>=</span> <span class=mf>0.8</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f03d00</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>FireflyUserNameTextFieldView</span><span class=p>:</span> <span class=mh>0x144f34260</span><span class=p>;</span> <span class=n>baseClass</span> <span class=o>=</span> <span class=n>UITextField</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>19</span> <span class=mi>26</span><span class=p>;</span> <span class=mi>221</span> <span class=mi>32</span><span class=p>);</span> <span class=n>text</span> <span class=o>=</span> <span class=err>&#39;&#39;</span><span class=p>;</span> <span class=n>clipsToBounds</span> <span class=o>=</span> <span class=n>YES</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x144f72190</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f39a50</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x146032820</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>10</span> <span class=mi>7</span><span class=p>;</span> <span class=mf>18.5</span> <span class=mf>18.5</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x146032670</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UITextFieldLabel</span><span class=p>:</span> <span class=mh>0x146033470</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>48</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>193</span> <span class=mi>32</span><span class=p>);</span> <span class=n>text</span> <span class=o>=</span> <span class=err>&#39;è¯·è¾“å…¥å‘˜å·¥å·&#39;</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>_UILabelLayer</span><span class=p>:</span> <span class=mh>0x146033680</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UILabelContentLayer</span><span class=p>:</span> <span class=mh>0x14606e1d0</span><span class=o>&gt;</span> <span class=p>(</span><span class=n>layer</span><span class=p>)</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>CSJCMBCCDSIPInputField</span><span class=p>:</span> <span class=mh>0x146034e00</span><span class=p>;</span> <span class=n>baseClass</span> <span class=o>=</span> <span class=n>UITextField</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>19</span> <span class=mi>77</span><span class=p>;</span> <span class=mi>221</span> <span class=mf>32.5</span><span class=p>);</span> <span class=n>text</span> <span class=o>=</span> <span class=err>&#39;&#39;</span><span class=p>;</span> <span class=n>clipsToBounds</span> <span class=o>=</span> <span class=n>YES</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x144f74e20</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x146034460</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x144f6bae0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>10</span> <span class=mi>7</span><span class=p>;</span> <span class=mf>18.5</span> <span class=mf>18.5</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f2f1b0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UITextFieldLabel</span><span class=p>:</span> <span class=mh>0x144f6d060</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>48</span> <span class=mi>0</span><span class=p>;</span> <span class=mi>193</span> <span class=mi>32</span><span class=p>);</span> <span class=n>text</span> <span class=o>=</span> <span class=err>&#39;è¯·è¾“å…¥å¯†ç &#39;</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>_UILabelLayer</span><span class=p>:</span> <span class=mh>0x144f6d270</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UILabelContentLayer</span><span class=p>:</span> <span class=mh>0x14606f280</span><span class=o>&gt;</span> <span class=p>(</span><span class=n>layer</span><span class=p>)</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>FireflyButton</span><span class=p>:</span> <span class=mh>0x144f6e6c0</span><span class=p>;</span> <span class=n>baseClass</span> <span class=o>=</span> <span class=n>UIButton</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>38</span> <span class=mf>120.5</span><span class=p>;</span> <span class=mi>183</span> <span class=mi>34</span><span class=p>);</span> <span class=n>clipsToBounds</span> <span class=o>=</span> <span class=n>YES</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144f6d690</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIButtonLabel</span><span class=p>:</span> <span class=mh>0x1460665c0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mf>73.5</span> <span class=mf>6.5</span><span class=p>;</span> <span class=mi>36</span> <span class=mf>21.5</span><span class=p>);</span> <span class=n>text</span> <span class=o>=</span> <span class=err>&#39;ç™»å½•&#39;</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>_UILabelLayer</span><span class=p>:</span> <span class=mh>0x1460667e0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UILabelContentLayer</span><span class=p>:</span> <span class=mh>0x144f67e20</span><span class=o>&gt;</span> <span class=p>(</span><span class=n>layer</span><span class=p>)</span>
   <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UINavigationBar</span><span class=p>:</span> <span class=mh>0x144da8880</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>20</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>44</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=p>;</span> <span class=n>tintColor</span> <span class=o>=</span> <span class=n>UIDeviceWhiteColorSpace</span> <span class=mi>1</span> <span class=mi>1</span><span class=p>;</span> <span class=n>gestureRecognizers</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>NSArray</span><span class=p>:</span> <span class=mh>0x14602ddd0</span><span class=o>&gt;</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x1460279d0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UINavigationBarBackground</span><span class=p>:</span> <span class=mh>0x146026f60</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=o>-</span><span class=mi>20</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>64</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>autoresize</span> <span class=o>=</span> <span class=n>W</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x14602b8b0</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>UIImageView</span><span class=p>:</span> <span class=mh>0x144db8f10</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span> <span class=mi>64</span><span class=p>;</span> <span class=mi>320</span> <span class=mi>0</span><span class=p>);</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x146023e00</span><span class=o>&gt;&gt;</span>
   <span class=o>|</span>    <span class=o>|</span>    <span class=o>|</span> <span class=o>&lt;</span><span class=nl>_UINavigationBarBackIndicatorView</span><span class=p>:</span> <span class=mh>0x14602cab0</span><span class=p>;</span> <span class=n>frame</span> <span class=o>=</span> <span class=p>(</span><span class=mi>8</span> <span class=mf>11.5</span><span class=p>;</span> <span class=mi>13</span> <span class=mi>21</span><span class=p>);</span> <span class=n>alpha</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>opaque</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>userInteractionEnabled</span> <span class=o>=</span> <span class=n>NO</span><span class=p>;</span> <span class=n>layer</span> <span class=o>=</span> <span class=o>&lt;</span><span class=nl>CALayer</span><span class=p>:</span> <span class=mh>0x144da7510</span><span class=o>&gt;&gt;</span>
<span class=o>&lt;</span><span class=n>CSNavJViewController</span> <span class=mh>0x1450fe000</span><span class=o>&gt;</span><span class=p>,</span> <span class=nl>state</span><span class=p>:</span> <span class=n>appeared</span><span class=p>,</span> <span class=nl>view</span><span class=p>:</span> <span class=o>&lt;</span><span class=n>UILayoutContainerView</span> <span class=mh>0x144d629d0</span><span class=o>&gt;</span>
   <span class=o>|</span> <span class=o>&lt;</span><span class=n>FireflyTestLoginViewController</span> <span class=mh>0x144f37c30</span><span class=o>&gt;</span><span class=p>,</span> <span class=nl>state</span><span class=p>:</span> <span class=n>appeared</span><span class=p>,</span> <span class=nl>view</span><span class=p>:</span> <span class=o>&lt;</span><span class=n>UIView</span> <span class=mh>0x14602d3a0</span><span class=o>&gt;</span>
<span class=n>a</span> <span class=mh>0x144f6e6c0</span>
<span class=o>-&gt;</span> <span class=n>loginButtonClick</span>
<span class=n>c</span> <span class=mh>0x144f6e6c0</span>
<span class=o>-&gt;</span> <span class=o>&lt;</span><span class=nl>FireflyTestLoginViewController</span><span class=p>:</span> <span class=mh>0x144f37c30</span><span class=o>&gt;</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°buttonå¯¹åº”çš„controllerä¸º<code>FireflyTestLoginViewController</code>ç±»ï¼ŒbuttonåŠ¨ä½œä¸º<code>loginButtonClick</code>ã€‚</p><p>å‰©ä¸‹å°±æ˜¯æ ¹æ®IDA&Hopperé™æ€åˆ†æMath-Oï¼Œé…åˆfridaDev traceæ‘¸æ¸…å‡½æ•°è°ƒç”¨æ ˆçš„å·¥ä½œäº†ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨lldbè°ƒè¯•btæ‰“å°å †æ ˆæ¥åˆ†æå‡½æ•°è°ƒç”¨ã€‚</p><p><img class=lazyload src=../svg/loading.min.svg data-src=iOS-Hook-FridaDev/5.png data-srcset="iOS-Hook-FridaDev/5.png, iOS-Hook-FridaDev/5.png 1.5x, iOS-Hook-FridaDev/5.png 2x" data-sizes=auto alt=iOS-Hook-FridaDev/5.png title=iOS-Hook-FridaDev/5.png></p><p>é¡ºè—¤ä½ ä¼šä¸€æ­¥æ­¥æ‘¸åˆ°åŠ è§£å¯†é€»è¾‘çš„ç“œã€‚</p><p><img class=lazyload src=../svg/loading.min.svg data-src=iOS-Hook-FridaDev/4.png data-srcset="iOS-Hook-FridaDev/4.png, iOS-Hook-FridaDev/4.png 1.5x, iOS-Hook-FridaDev/4.png 2x" data-sizes=auto alt=iOS-Hook-FridaDev/4.png title=iOS-Hook-FridaDev/4.png></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2018-11-30</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=../tags/ios.html>iOS</a>,&nbsp;<a href=../tags/frida.html>Frida</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=../>Home</a></span></section></div><div class=post-nav><a href=../posts/ios%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0.html class=prev rel=prev title=iOSé€†å‘ç¬”è®°><i class="fas fa-angle-left fa-fw"></i>iOSé€†å‘ç¬”è®°</a>
<a href=../posts/blockchain-security-articles.html class=next rel=next title="Blockchain Security Articles">Blockchain Security Articles<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=valine class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://valine.js.org/>Valine</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2018 - 2020</span>&nbsp;|&nbsp;<span class=license>Houugen</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=../lib/valine/valine.min.css><script type=text/javascript src=../lib/valine/Valine.min.js></script><script type=text/javascript src=../lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=../lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=../lib/algoliasearch/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=../lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=../lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":20},"comment":{"valine":{"appId":"QhRivi4Qm3PjvD0WoqEiJv5n-gzGzoHsz","appKey":"gHPJRKJ7Vfi2xHjiJ3AcP92S","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"serverURLs":"https://leancloud.cn","visitor":true}},"search":{"algoliaAppID":"63ROI1DYLO","algoliaIndex":"houugen_blog","algoliaSearchKey":"0282c2777b386667ccc099a27da8a3cb","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type=text/javascript src=../js/theme.min.js></script></body></html>